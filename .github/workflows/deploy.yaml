name: Build

on:
    # Triggers the workflow on push or pull request events but only for the "master" branch
    push:
        branches: ["master"]
    pull_request:
        branches: ["master"]

# Requires content write permission
permissions:
    contents: write
    pages: write
    id-token: write

jobs:
    build:
        runs-on: ubuntu-latest

        steps:
            # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
            - name: Checkout ğŸ›ï¸
              uses: actions/checkout@v3

            # Run compilation script with Rust
            - name: Build ğŸ”§
              run: cargo run

            # Push changes with plugin
            # - name: Deploy ğŸš€
            #   uses: JamesIves/github-pages-deploy-action@v4
            #   with:
            #       # This must be the build directory
            #       folder: ./build

    deploy:
      environment:
        name: github-pages
        url: ${{ steps.deployment.outputs.page_url }}
      runs-on: ubuntu-latest
      steps:
        - name: Checkout
          uses: actions/checkout@v4
        - name: Setup Pages
          uses: actions/configure-pages@v4
        - name: Upload artifact
          uses: actions/upload-pages-artifact@v2
          with:
            # Upload entire repository
            path: 'build'
        - name: Deploy to GitHub Pages
          id: deployment
          uses: actions/deploy-pages@v3
